//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////
///			Copyright 2018 (C) Bruno Xavier B. Leite
//////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include "IUSQLEditor.h"
#include "USQLEditor_Shared.h"

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#define LOCTEXT_NAMESPACE "Synaptech"

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void FUSQLEditor::StartupModule() {
	IAssetTools &AssetTools = FModuleManager::LoadModuleChecked<FAssetToolsModule>("AssetTools").Get();
	SY_AssetCategory = AssetTools.RegisterAdvancedAssetCategory(FName(TEXT("Synaptech")),LOCTEXT("SynaptechCategory","Synaptech"));
	{
		TSharedRef<IAssetTypeActions> ACT_SQLite = MakeShareable(new FATA_USQLite);
		AssetTools.RegisterAssetTypeActions(ACT_SQLite);
	}
	//
	FLevelEditorModule &LevelEditorModule = FModuleManager::LoadModuleChecked<FLevelEditorModule>("LevelEditor");
	{
		FPropertyEditorModule &PropertyEditorModule = FModuleManager::LoadModuleChecked<FPropertyEditorModule>("PropertyEditor");
		PropertyEditorModule.RegisterCustomClassLayout("SQLite",FOnGetDetailCustomizationInstance::CreateStatic(&FUSQLDetails::MakeInstance));
		PropertyEditorModule.RegisterCustomPropertyTypeLayout("SQLTable",FOnGetPropertyTypeCustomizationInstance::CreateStatic(&FUSQLTableDetails::MakeInstance));
		PropertyEditorModule.RegisterCustomPropertyTypeLayout("SQLPreview",FOnGetPropertyTypeCustomizationInstance::CreateStatic(&FUSQLPreviewDetails::MakeInstance));
		PropertyEditorModule.RegisterCustomPropertyTypeLayout("SQLVersion",FOnGetPropertyTypeCustomizationInstance::CreateStatic(&FUSQLVersionDetails::MakeInstance));
	}
	//
	FSQLStyle::Initialize();
}

void FUSQLEditor::ShutdownModule() {
	FSQLStyle::Shutdown();
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#undef LOCTEXT_NAMESPACE
#undef PLUGIN_NAME

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

IMPLEMENT_MODULE(FUSQLEditor,USQLEditor);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////